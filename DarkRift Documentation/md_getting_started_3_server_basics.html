<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DarkRift: Server Basics</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=DM+Sans&display=swap" rel="stylesheet">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="dr2_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="dr2_logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">DarkRift<span id="projectnumber">&#160;2.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_getting_started_3_server_basics.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Server Basics </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md223"></a>
A Brief Overview</h1>
<p >Before we jump into the art of DarkRift we should explore how DarkRift operates.</p>
<p >DarkRift uses <b>plugins</b> to implement all server side logic, you write plugins as you would develop a standard .NET library and then you just drop the generated DLL into DarkRift’s ‘Plugins’ directory. DarkRift offers a large API for managing clients and sending messages etc. and provides events that inform your plugins when a client connects, sends a message etc.</p>
<p ><img src="https://www.darkriftnetworking.com/DarkRift2/Docs/2.10.0/images/getting_started/architecture.png" alt="Architecture Diagram" title="DarkRift&apos;s Architecture" class="inline"/></p>
<p >Everything related to the <b>server</b> code is in the namespace <code>DarkRift.Server</code>, everything to do with the <b>client</b> in <code>DarkRift.Client</code> and everything used in <b>both</b> is just in <code>DarkRift</code>. </p>
<h1><a class="anchor" id="autotoc_md224"></a>
Setting up the Plugin</h1>
<p >Create a new <code>Class Library C# project</code> in Visual Studio named something like “AgarPlugin” and add <b>references</b> to <code>DarkRift.Server.dll</code> and <code>DarkRift.dll</code>.</p>
<p ><b>Rename</b> the default class to <code>AgarPlayerManager</code> and rename the file similarly. Add using directives to the top of the file (<code>using DarkRift;</code> and <code>using DarkRift.Server;</code>) so that we have access to both <code>DarkRift.Server</code> and <code>DarkRift</code> <b>namespaces</b>.</p>
<p >All plugins in DarkRift must <b>inherit</b> from <code>DarkRift.Server.Plugin</code> so that DarkRift can correctly discover and instantiate them and so it can easily read details about your plugin. It is also your entry point into DarkRift’s API so that you make changes on the correct server instances.</p>
<p >Go ahead and make <code>AgarPlayerManager</code> <b>inherit</b> from <code>Plugin</code>, you’ll notice Visual Studio throws an error saying that there is no <b>constructor</b> so add it. You’ll then notice it says that it does not implement a number of abstract properties, once again add them. If you’re following along, you should have a class like this: </p><div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>AgarPlayerManager : Plugin</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> AgarPlayerManager(PluginLoadData pluginLoadData) : base(pluginLoadData)</div>
<div class="line">    {</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> ThreadSafe</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">get</span></div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> NotImplementedException();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> Version Version</div>
<div class="line">    {</div>
<div class="line">        <span class="keyword">get</span></div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">throw</span> <span class="keyword">new</span> NotImplementedException();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> Hopefully the autogenerated properties should be fairly self-explanatory. When implementing them remember:</p><ul>
<li><code>Version</code> should follow <a href="http://semver.org">Semantic Versioning</a> (unless you really hate best practices). It is used to trigger upgrades to plugins (we’ll cover that later) so you should give it a default value now.</li>
<li><code>ThreadSafe</code> indicates whether your program can handle multithreaded events to boost performance. Since I won’t cover any multithreading in this set it to false, if you know about multithreading then it might be a nice exercise at the end to reimplement the plugin with multithreading enabled!</li>
</ul>
<p >After some formatting, we should have something like: </p><div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>AgarPlayerManager : Plugin</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> <span class="keywordtype">bool</span> ThreadSafe =&gt; <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keyword">override</span> Version Version =&gt; <span class="keyword">new</span> Version(1, 0, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> AgarPlayerManager(PluginLoadData pluginLoadData) : base(pluginLoadData)</div>
<div class="line">    {</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> If you want to try it you can <b>build</b> the library and place the <b>DLL</b> in <b>DarkRift’s plugins folder</b>, when you start DarkRift you should see your plugin get loaded in! </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
