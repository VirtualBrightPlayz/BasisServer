<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DarkRift: The Unity Scene</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=DM+Sans&display=swap" rel="stylesheet">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="dr2_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="dr2_logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">DarkRift<span id="projectnumber">&#160;2.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_getting_started_2_the_unity_scene.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">The Unity Scene </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md218"></a>
Setting Up DarkRift</h1>
<p >In a blank Unity scene add an empty GameObject, rename it <code>Network</code> and then add a <code>DarkRift -&gt; Client</code> component.</p>
<p >This is the first fundamental DarkRift part, the client script connects to the server for you and allows you to send and receive messages - plus it even has some useful tools built in for you! Let’s look at the Unity interface for it.</p>
<p ><img src="https://www.darkriftnetworking.com/DarkRift2/Docs/2.10.0/images/getting_started/unity_client.png" alt="UnityClient settings" title="The settings for the UnityClient" class="inline"/></p>
<ul>
<li><code>Address</code> is the host IP address that the server you wish to connect to is located on, by default it’s set to local host (the same computer you’re running the game on) for development.</li>
<li><code>Port</code> is the port number you’ve set the server to listen on, by default it’s 4296.</li>
<li><code>IP Version</code> is the type of IP address that you want to connect to the server with, this is most likely IPv4.</li>
<li><code>Auto Connect</code> means that the client will try and establish a connection when Unity invokes the Start method. If you turn this off, you’ll need to manually call UnityClient.Connect() from your code.</li>
<li><code>Invoke From Dispatcher</code> means the client will raise all events from Unity’s main thread so that you don’t need to worry about synchronization and multi-threading. If you disable this, you’ll need to handle synchronization and dispatching to the main thread yourself but you should see performance benefits. See Dispatcher.</li>
<li><code>Sniff Data</code> Data means that the client will print the details of messages received for debugging purposes.</li>
</ul>
<p >Leave everything as is.</p>
<h1><a class="anchor" id="autotoc_md219"></a>
Players</h1>
<p >Download or make a white circle with a transparent background so we can colour it for different players, the higher the resolution the better. I used this <a href="https://goo.gl/images/hK8leu">big white circle</a>.</p>
<p >Create a C# script called <code>AgarObject</code> and add the following helper functions that we’ll come to use later: </p><div class="fragment"><div class="line">[RequireComponent(typeof(Renderer))]</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>AgarObject : MonoBehaviour</div>
<div class="line">{</div>
<div class="line">    [SerializeField]</div>
<div class="line">    [Tooltip(<span class="stringliteral">&quot;The speed that the player will move.&quot;</span>)]</div>
<div class="line">    <span class="keywordtype">float</span> speed = 1f;</div>
<div class="line"> </div>
<div class="line">    [SerializeField]</div>
<div class="line">    [Tooltip(<span class="stringliteral">&quot;Multiplier for the scaling of the player.&quot;</span>)]</div>
<div class="line">    <span class="keywordtype">float</span> scale = 1f;</div>
<div class="line"> </div>
<div class="line">    Vector3 movePosition;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> Awake()</div>
<div class="line">    {</div>
<div class="line">        movePosition = transform.position;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> Update()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (speed != 0f)</div>
<div class="line">            transform.position = Vector3.MoveTowards(transform.position, movePosition, speed * Time.deltaTime);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> SetColor(Color32 color)</div>
<div class="line">    {</div>
<div class="line">        Renderer renderer = GetComponent&lt;Renderer&gt;();</div>
<div class="line">        renderer.material.color = color;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> SetRadius(<span class="keywordtype">float</span> radius)</div>
<div class="line">    {</div>
<div class="line">        transform.localScale = <span class="keyword">new</span> Vector3(radius * scale, radius * scale, 1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">void</span> SetMovePosition(Vector3 newPosition)</div>
<div class="line">    {</div>
<div class="line">        movePosition = newPosition;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> Add this script to a new Sprite GameObject and assign the white circle sprite to the sprite field of the <code>SpriteRenderer</code>. Make it a prefab called <code>NetworkPlayer</code> and then create a new C# script called <code>MouseController</code>: </p><div class="fragment"><div class="line">[RequireComponent(typeof(AgarObject))]</div>
<div class="line"><span class="keyword">public</span> <span class="keyword">class </span>MouseController : MonoBehaviour</div>
<div class="line">{</div>
<div class="line">    AgarObject agarObject;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> Awake()</div>
<div class="line">    {</div>
<div class="line">        agarObject = GetComponent&lt;AgarObject&gt;();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> Update ()</div>
<div class="line">    {</div>
<div class="line">        Vector3 mousePoint = Camera.main.ScreenToWorldPoint(Input.mousePosition);</div>
<div class="line">        mousePoint.z = 0;</div>
<div class="line"> </div>
<div class="line">        agarObject.SetMovePosition(mousePoint);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> Add the <code>MouseController</code> script to the <code>NetworkPlayer</code> GameObject and make it a separate prefab called <code>ControllablePlayer</code> (for clarity you should now have <b>2 versions</b>: <code>NetworkPlayer</code> <b>without</b> <code>MouseController</code> and <code>ControllablePlayer</code> <b>with</b> <code>MouseController</code>). You should be able to test your player and get a feel for the right speed value for you.</p>
<p >Make sure the <b>speed</b> on the <code>NetworkPlayer</code> is maybe <b>1.5x</b> the speed on the <code>ControllablePlayer</code>.</p>
<h1><a class="anchor" id="autotoc_md220"></a>
Food</h1>
<p >Download or make a food-like white square with a transparent background so we can give it different colours. Since it’s a square the transparent background might not be necessary. I used this <a href="https://goo.gl/images/lOA64v">big white square</a>.</p>
<p >Make a new prefab consisting only of the square and the <code>AgarObject</code> script, set the <b>speed</b> of it to <b>0</b> and then ensure your scene only consists of our <code>Network</code> object and <code>Main Camera</code>.</p>
<h1><a class="anchor" id="autotoc_md221"></a>
Camera</h1>
<p >Lastly, before we get started with the networking create a <code>CameraFollow</code> script containing the following: </p><div class="fragment"><div class="line"><span class="keyword">public</span> <span class="keyword">class </span>CameraFollow : MonoBehaviour</div>
<div class="line">{</div>
<div class="line">    [SerializeField]</div>
<div class="line">    <span class="keyword">public</span> <span class="keywordtype">float</span> speed = 5f;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">public</span> Transform Target { <span class="keyword">get</span>; <span class="keyword">set</span>; }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> Update ()</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordflow">if</span> (Target != <span class="keyword">null</span>)</div>
<div class="line">        {</div>
<div class="line">            Vector3 targetPos = Target.GetComponent&lt;Renderer&gt;().bounds.center;</div>
<div class="line">            transform.position = Vector3.Lerp(</div>
<div class="line">                transform.position,</div>
<div class="line">                <span class="keyword">new</span> Vector3(targetPos.x, targetPos.y, transform.position.z),</div>
<div class="line">                speed * Time.deltaTime</div>
<div class="line">            );</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p> Add the <code>CameraFollow</code> script to the <code>Main Camera</code> so we can use it later and set the <b>camera’s background</b> colour to a <b>white</b> colour.</p>
<p >Because we’re making a 2D game make sure your <b>Scene View</b> is in <b>2D mode</b> and make the camera <b>orthographic</b>.</p>
<p >Now is a good time to save and backup your work/commit if you haven’t done so yet. That’s all the client side logic we’re going to do for now! </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
