<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DarkRift: Server Clustering API Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=DM+Sans&display=swap" rel="stylesheet">
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="dr2_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="dr2_logo.svg"/></td>
  <td id="projectalign">
   <div id="projectname">DarkRift<span id="projectnumber">&#160;2.11.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_advanced_clustering_server_clustering_api_overview.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Server Clustering API Overview </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >Once a server is part of a cluster it becomes possible to communicate with other members of the cluster. This is primarily achieved using the remote server manager which will be discussed in brief here.</p>
<h1><a class="anchor" id="autotoc_md11"></a>
Remote Server Manager</h1>
<p >The <code>IRemoteServerManager</code> interface is a logical equivalent of the <code>IClientManager</code> interface for remote servers. It provides an API to access <code>IRemoteClient</code> objects (which are the logical equivalent of an <code>IClient</code>) and also to get details about the current server. Unlike the client manager however, the server manager provides the servers in via their respective server groups.</p>
<p >Remote servers are only accessible in the remote server manager if the server group they belong to is connected with the server group of the current server. Additionally, servers in the server group of the current server are not accessible.</p>
<p >The following code is written from the perspective of a plugin.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
Accessing Servers</h2>
<p >In most cases you will access servers by knowing what group they're in. </p><div class="fragment"><div class="line">IServerGroup serverGroup = RemoteServerManager.GetGroup(groupName);</div>
<div class="line">IRemoteServer[] remoteServers = serverGroup.GetAllRemoteServers();</div>
</div><!-- fragment --><p >If the ID of a server is known then it can be accessed by performing a search of all groups. </p><div class="fragment"><div class="line">IRemoteServer remoteServer = RemoteServerManager.FindServer(<span class="keywordtype">id</span>);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md13"></a>
Server Groups</h1>
<p >The <code>IServerGroup</code> interface represents a single server group and provides methods to access the remote server objects in that group. It also provides events that allow you to detect servers joining and leaving that group, in a similar way to the client manager does.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
Using Events</h2>
<p >You can subscribe to join an leave events which are triggered when the registry informs the server about the new/leaving remote server. </p><div class="fragment"><div class="line">serverGroup.ServerJoined += ServerJoined;</div>
<div class="line">serverGroup.ServerLeft += ServerLeft;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> ServerJoined(<span class="keywordtype">object</span> sender, ServerJoinedEventArgs args)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Do something here</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> ServerLeft(<span class="keywordtype">object</span> sender, ServerLeftEventArgs args)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Do something here</span></div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
Accessing Servers</h2>
<p >To get all remote servers in a group the following code can be used. </p><div class="fragment"><div class="line">IRemoteServer[] remoteServers = serverGroup.GetAllRemoteServers();</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
Remote Servers</h1>
<p >The <code>IRemoteServer</code> interface is the logical equivalent of the <code>IClient</code> interface for servers. It provides methods to interact with a remote server.</p>
<p >Note, that an instance of <code>IRemoteServer</code> is not always connected to the remote server in particular as connection is established following the server joining and if a reconnection is underway. Accessing certain properties on the <code>IRemoteServer</code> may return <code>null</code> and sending messages may return <code>false</code> if the remote server is not connected when the operation is performed.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Sending messages</h2>
<p >Sending messages is done in much the same way you would send to a client. </p><div class="fragment"><div class="line"><span class="keyword">using</span> (DarkRiftWriter writer = DarkRiftWriter.Create())</div>
<div class="line">{</div>
<div class="line">    writer.Write(someData);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using</span> (Message message = Message.Create(0, writer))</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">bool</span> success = remoteServer.SendMessage(message, SendMode.Reliable);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md18"></a>
Receiving Messages</h2>
<p >Similarly receiving messages is fairly similar to receiving from a client. </p><div class="fragment"><div class="line">remoteServer.MessageRecevied += MessageRecevied;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> MessageReceived(<span class="keywordtype">object</span> sender, ServerMessageReceivedEventArgs e)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">using</span> (Message message = e.GetMessage())</div>
<div class="line">    <span class="keyword">using</span> (DarkRiftReader reader = message.GetReader())</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Do something</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5 </li>
  </ul>
</div>
</body>
</html>
